See inline comments for details.

output screenshots:

![plot](./TestCodeScreenshot.png)
![plot](./OutputScreenshot.png)

